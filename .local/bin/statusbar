#!/bin/sh
#killall statusbar

	#xsetroot -name " BAT1: $(cat /sys/class/power_supply/BAT0/capacity)% | BRIGHT: $(printf %.0f $(light -G))% | VOL: $(pamixer --get-volume-human) | $(date +'%a %h %d %r %Z %Y') | ðŸ„¯ "
	#xsetroot -name " BAT1: $(cat /sys/class/power_supply/BAT0/capacity)% | BRIGHT: $(printf %.0f $(light -G))% | VOL: $(pamixer --get-volume-human) | $(date +'%a %h %d %r %Z %Y') | ïŠ– "


# Basic status bar
get_wifi ()
{
	#sudo wpa_cli status | grep bssid > /dev/null && WIFI=ï‡« || WIFI="!ï‡« "

	WIFI="X"
	case "$( sudo wpa_cli status | sed -n '2p' )" in
		bssid*) WIFI=ó°–©  ;;
		wpa_state=INTERFACE_DISABLED) WIFI="ó±šµ" ;;
		*SCANNING*) WIFI="ó±š¾" ;;
	esac
}

while true; do
	[ $( cat /sys/class/power_supply/BAT0/status ) = "Charging" ] && BAT_STATUS="î«´" || BAT_STATUS="î«³"
	VOL="$( pamixer --get-volume-human )" ; [ $VOL = "muted" ] && VOL="î¬¤"
	#[ $(pamixer --get-volume-human) = "muted" ] && VOL="ðŸ”‡" || VOL=$(pamixer --get-volume-human)
	get_wifi

	#xsetroot -name " ó°‚„: $(cat /sys/class/power_supply/BAT0/capacity)% $BAT_STATUS | $WIFI | ï”¢ $(printf %.0f $(light -G))% | ó°•¾ $VOL | $(date +'%a %h %d %r %Z %Y') | ó°³¶ "
	xsetroot -name " ó°‚„: $(cat /sys/class/power_supply/BAT0/capacity)% $BAT_STATUS | $WIFI | ï”¢ $(printf %.0f $(light -G))% | ó°•¾ $VOL | $(date +'%a %h %d %r') | ó°³¶ "
	[ "$(cat /sys/class/power_supply/BAT0/capacity)" = 20 ] && [ "$(cat /sys/class/power_supply/BAT0/status)" != "Charging" ] && notify-send -a dwm -u critical -r 999 -i ~/.local/share/icons/Flat-Yellow/devices/scalable/battery-empty.svg Battery "Battery is critically low, please charge immediately."
        sleep 1
done 
